name: Test Secret Access

on:
  pull_request:
    branches:
      - main

jobs:
  test-secret:
    runs-on: ubuntu-latest
    environment: test
    
    steps:
      - name: Check if fork PR
        run: |
          echo "Event name: ${{ github.event_name }}"
          echo "PR head repo: ${{ github.event.pull_request.head.repo.full_name }}"
          echo "Base repo: ${{ github.event.pull_request.base.repo.full_name }}"
          echo "Is fork: ${{ github.event.pull_request.head.repo.full_name != github.event.pull_request.base.repo.full_name }}"
      
      - name: Echo secret (should be obfuscated for Tetra PRs, empty for fork PRs)
        env:
          FOO: ${{ secrets.FOO }}
        run: |
          echo "Testing secret FOO..."
          echo "FOO value: $FOO"
          echo "FOO length: ${#FOO}"
          
          if [ -z "$FOO" ]; then
            echo "::warning::SECRET IS EMPTY - This is expected for fork PRs or if secret is not set"
          else
            echo "::notice::Secret is present and should be obfuscated in logs (showing as ***)"
          fi

